---
const features = [
  {
    id: 'gestion-pedidos',
    title: 'Gestión de Pedidos',
    description: 'Recibe pedidos de Shopify y WooCommerce automáticamente. Gestiona estados, pagos, canales de venta y notas desde un solo panel.',
    detail: 'Centraliza todos tus canales de venta en una única interfaz. Filtra por estado, transportadora o fecha. Asigna pedidos a bodegas y genera envíos con un clic.',
    url: 'app.binah.co/pedidos',
  },
  {
    id: 'whatsapp-ia',
    title: 'WhatsApp con IA',
    description: 'Chatbot inteligente que atiende clientes, detecta pedidos y escala a tu equipo. Campañas masivas, plantillas y gestión multicanal.',
    detail: 'El chatbot responde consultas frecuentes, confirma estados de pedido y escala automáticamente a un agente humano cuando detecta intención de compra.',
    url: 'app.binah.co/whatsapp',
  },
  {
    id: 'envios-integrados',
    title: 'Envíos Integrados',
    description: 'Genera guías de Coordinadora y 99 Envíos con un clic. Cotiza, imprime rótulos y rastrea paquetes en tiempo real.',
    detail: 'Compara tarifas entre transportadoras, genera guías masivas y envía notificaciones automáticas de tracking a tus clientes por WhatsApp.',
    url: 'app.binah.co/envios',
  },
  {
    id: 'facturacion-siigo',
    title: 'Facturación con Siigo',
    description: 'Genera facturas y comprobantes de pago en Siigo automáticamente. Multi-credencial con ruteo condicional por bodega y método de pago.',
    detail: 'Facturación electrónica DIAN, multi-credencial para diferentes razones sociales y ruteo inteligente según bodega de despacho o medio de pago.',
    url: 'app.binah.co/facturas',
  },
  {
    id: 'inventario',
    title: 'Inventario Multi-bodega',
    description: 'Control de stock en tiempo real entre múltiples bodegas. Alertas de bajo inventario, transferencias y sincronización con tu tienda.',
    detail: 'Gestiona stock en múltiples ubicaciones, configura alertas de reposición y sincroniza automáticamente con Shopify y WooCommerce.',
    url: 'app.binah.co/inventario',
  },
  {
    id: 'automatizaciones',
    title: 'Automatizaciones',
    description: 'Flujos automáticos que conectan pedidos, envíos, facturación y mensajes de WhatsApp. Dispara acciones por webhooks o cambios de estado.',
    detail: 'Crea flujos personalizados que se ejecutan automáticamente. Conecta cualquier acción con webhooks entrantes y salientes.',
    url: 'app.binah.co/automatizaciones',
  },
];

const navItems = features.map((f) => ({ id: f.id, label: f.title }));
---

<section id="funcionalidades" class="bg-[#f8f9fa] py-20 lg:py-28">
  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
    <div class="text-center mb-16">
      <h2 class="text-4xl lg:text-5xl font-extrabold tracking-tight text-[#171e19] leading-[1.1]">
        Todo lo que necesitas para <span class="text-[#4d37f6]">vender más</span>
      </h2>
      <p class="mt-4 text-lg font-medium text-slate-500 max-w-2xl mx-auto leading-relaxed">
        Funcionalidades integradas que trabajan juntas para potenciar tu operación de e-commerce.
      </p>
    </div>

    <div class="grid lg:grid-cols-[280px_1fr] gap-12">
      <!-- Sticky sidebar -->
      <div class="hidden lg:block">
        <nav class="sticky top-28 space-y-1">
          {navItems.map((item) => (
            <a
              href={`#${item.id}`}
              data-feature-nav
              class="feature-nav-link flex items-center gap-3 px-4 py-3 rounded-lg transition-all duration-500 text-slate-400 font-medium text-sm hover:text-[#171e19] group"
            >
              <span class="w-1.5 h-1.5 rounded-full bg-slate-300 transition-all duration-500 group-hover:bg-[#4d37f6] feature-nav-dot"></span>
              {item.label}
            </a>
          ))}
        </nav>
      </div>

      <!-- Feature content -->
      <div class="space-y-24">
        {features.map((feature, i) => (
          <div
            id={feature.id}
            data-feature-section
            class={`grid md:grid-cols-2 gap-8 items-center ${i % 2 !== 0 ? 'md:[direction:rtl] md:[&>*]:[direction:ltr]' : ''}`}
          >
            <!-- Text -->
            <div>
              <h3 class="text-2xl lg:text-3xl font-extrabold tracking-tight text-[#171e19] mb-4">
                {feature.title}
              </h3>
              <p class="text-slate-500 font-medium leading-relaxed mb-4">
                {feature.description}
              </p>
              <p class="text-slate-400 font-medium leading-relaxed text-sm">
                {feature.detail}
              </p>
            </div>

            <!-- Visual: Dashboard mockup -->
            <div class="rounded-xl overflow-hidden border border-gray-200 shadow-lg bg-white">
              <!-- Browser chrome -->
              <div class="bg-[#171e19] h-8 px-3 flex items-center gap-2">
                <div class="flex gap-1.5">
                  <div class="w-2.5 h-2.5 rounded-full bg-[#ff5f57]"></div>
                  <div class="w-2.5 h-2.5 rounded-full bg-[#febc2e]"></div>
                  <div class="w-2.5 h-2.5 rounded-full bg-[#28c840]"></div>
                </div>
                <div class="flex-1 flex justify-center">
                  <div class="bg-white/10 rounded px-3 py-0.5 text-white/40 text-[10px] font-medium">
                    {feature.url}
                  </div>
                </div>
                <div class="w-10"></div>
              </div>

              <!-- ============ ORDERS MOCKUP ============ -->
              {feature.id === 'gestion-pedidos' && (
                <div class="p-3 bg-[#f8f9fa]">
                  <div class="flex gap-1.5 mb-3 flex-wrap">
                    <span class="bg-[#4d37f6] text-white text-[10px] font-bold px-2.5 py-1 rounded-full">Todos (847)</span>
                    <span class="bg-white text-slate-400 text-[10px] font-medium px-2.5 py-1 rounded-full border border-gray-200">Pendientes</span>
                    <span class="bg-white text-slate-400 text-[10px] font-medium px-2.5 py-1 rounded-full border border-gray-200">En proceso</span>
                    <span class="bg-white text-slate-400 text-[10px] font-medium px-2.5 py-1 rounded-full border border-gray-200">Entregados</span>
                  </div>
                  <div class="bg-white rounded-lg border border-gray-100 overflow-hidden">
                    <table class="w-full text-[10px]">
                      <thead>
                        <tr class="border-b border-gray-100 bg-gray-50/80">
                          <th class="text-left py-2 px-3 text-gray-400 font-medium">Pedido</th>
                          <th class="text-left py-2 px-3 text-gray-400 font-medium hidden sm:table-cell">Cliente</th>
                          <th class="text-left py-2 px-3 text-gray-400 font-medium">Total</th>
                          <th class="text-left py-2 px-3 text-gray-400 font-medium hidden sm:table-cell">Canal</th>
                          <th class="text-right py-2 px-3 text-gray-400 font-medium">Estado</th>
                        </tr>
                      </thead>
                      <tbody>
                        {[
                          { id: '#1847', client: 'María García', total: '$245,000', channel: 'Shopify', channelColor: 'bg-green-50 text-green-700', status: 'Entregado', statusColor: 'bg-emerald-100 text-emerald-700' },
                          { id: '#1846', client: 'Carlos López', total: '$180,500', channel: 'Woo', channelColor: 'bg-purple-50 text-purple-700', status: 'En proceso', statusColor: 'bg-[#ede9fe] text-[#4d37f6]' },
                          { id: '#1845', client: 'Ana Rodríguez', total: '$92,000', channel: 'Shopify', channelColor: 'bg-green-50 text-green-700', status: 'Pendiente', statusColor: 'bg-amber-100 text-amber-700' },
                          { id: '#1844', client: 'José Martínez', total: '$310,200', channel: 'Woo', channelColor: 'bg-purple-50 text-purple-700', status: 'Entregado', statusColor: 'bg-emerald-100 text-emerald-700' },
                          { id: '#1843', client: 'Laura Torres', total: '$156,800', channel: 'Shopify', channelColor: 'bg-green-50 text-green-700', status: 'En proceso', statusColor: 'bg-[#ede9fe] text-[#4d37f6]' },
                        ].map((order) => (
                          <tr class="border-b border-gray-50 last:border-0">
                            <td class="py-2 px-3 font-bold text-[#171e19]">{order.id}</td>
                            <td class="py-2 px-3 text-gray-500 hidden sm:table-cell">{order.client}</td>
                            <td class="py-2 px-3 text-gray-600 font-medium">{order.total}</td>
                            <td class="py-2 px-3 hidden sm:table-cell">
                              <span class={`inline-block text-[8px] font-bold px-1.5 py-0.5 rounded ${order.channelColor}`}>{order.channel}</span>
                            </td>
                            <td class="py-2 px-3 text-right">
                              <span class={`inline-block text-[8px] font-bold px-1.5 py-0.5 rounded ${order.statusColor}`}>{order.status}</span>
                            </td>
                          </tr>
                        ))}
                      </tbody>
                    </table>
                  </div>
                </div>
              )}

              <!-- ============ WHATSAPP MOCKUP ============ -->
              {feature.id === 'whatsapp-ia' && (
                <div>
                  <div class="bg-[#075e54] px-3 py-2 flex items-center gap-2">
                    <div class="w-7 h-7 rounded-full bg-white/20 flex items-center justify-center shrink-0">
                      <span class="text-white text-[10px] font-bold">MG</span>
                    </div>
                    <div class="min-w-0">
                      <div class="text-white text-[11px] font-medium">María García</div>
                      <div class="text-white/60 text-[9px]">+57 311 456 7890</div>
                    </div>
                    <div class="ml-auto shrink-0">
                      <span class="bg-[#25d366] text-white text-[8px] font-bold px-1.5 py-0.5 rounded-full flex items-center gap-1">
                        <span class="w-1 h-1 rounded-full bg-white animate-pulse"></span>
                        IA Activa
                      </span>
                    </div>
                  </div>
                  <div class="bg-[#ece5dd] p-3 space-y-2">
                    <div class="flex justify-end">
                      <div class="bg-[#dcf8c6] rounded-lg rounded-tr-sm px-2.5 py-1.5 max-w-[78%] shadow-sm">
                        <p class="text-[11px] text-[#303030] leading-relaxed">Hola, quiero saber el estado de mi pedido #1847</p>
                        <span class="text-[8px] text-gray-500 float-right mt-0.5 ml-2">10:42 AM</span>
                      </div>
                    </div>
                    <div class="flex justify-start">
                      <div class="bg-white rounded-lg rounded-tl-sm px-2.5 py-1.5 max-w-[82%] shadow-sm">
                        <div class="flex items-center gap-1 mb-0.5">
                          <span class="bg-[#4d37f6] text-white text-[7px] font-bold px-1 py-px rounded">IA</span>
                          <span class="text-[8px] text-gray-400">Binah Bot</span>
                        </div>
                        <p class="text-[11px] text-[#303030] leading-relaxed">¡Hola María! Tu pedido #1847 fue despachado con Coordinadora. Guía: CR-789456. Llegada estimada: mañana entre 2-5pm.</p>
                        <span class="text-[8px] text-gray-500 float-right mt-0.5 ml-2">10:42 AM</span>
                      </div>
                    </div>
                    <div class="flex justify-end">
                      <div class="bg-[#dcf8c6] rounded-lg rounded-tr-sm px-2.5 py-1.5 max-w-[78%] shadow-sm">
                        <p class="text-[11px] text-[#303030] leading-relaxed">Perfecto, gracias!</p>
                        <span class="text-[8px] text-gray-500 float-right mt-0.5 ml-2">10:43 AM</span>
                      </div>
                    </div>
                    <div class="flex justify-start">
                      <div class="bg-white rounded-lg rounded-tl-sm px-2.5 py-1.5 max-w-[82%] shadow-sm">
                        <div class="flex items-center gap-1 mb-0.5">
                          <span class="bg-[#4d37f6] text-white text-[7px] font-bold px-1 py-px rounded">IA</span>
                        </div>
                        <p class="text-[11px] text-[#303030] leading-relaxed">¡Con gusto! ¿Necesitas algo más? Estoy aquí para ayudarte.</p>
                        <span class="text-[8px] text-gray-500 float-right mt-0.5 ml-2">10:43 AM</span>
                      </div>
                    </div>
                  </div>
                </div>
              )}

              <!-- ============ SHIPPING MOCKUP ============ -->
              {feature.id === 'envios-integrados' && (
                <div class="p-3 bg-[#f8f9fa] space-y-3">
                  <div class="text-[10px] text-gray-400 font-medium">Cotización — Pedido #1847 · Bogotá → Medellín</div>
                  <div class="grid grid-cols-2 gap-2">
                    <div class="bg-white rounded-lg p-3 border border-gray-200 transition-all">
                      <div class="flex items-center gap-1.5 mb-2">
                        <div class="w-5 h-5 rounded bg-orange-100 flex items-center justify-center">
                          <span class="text-orange-600 text-[8px] font-bold">CO</span>
                        </div>
                        <span class="font-bold text-[11px] text-[#171e19]">Coordinadora</span>
                      </div>
                      <div class="text-base font-extrabold text-[#171e19]">$12,500</div>
                      <div class="text-[9px] text-gray-400 mt-0.5">2-3 días hábiles</div>
                    </div>
                    <div class="bg-white rounded-lg p-3 border-2 border-[#4d37f6] relative">
                      <span class="absolute -top-2 right-2 bg-[#4d37f6] text-white text-[7px] font-bold px-1.5 py-0.5 rounded-full">Mejor precio</span>
                      <div class="flex items-center gap-1.5 mb-2">
                        <div class="w-5 h-5 rounded bg-blue-100 flex items-center justify-center">
                          <span class="text-blue-600 text-[8px] font-bold">99</span>
                        </div>
                        <span class="font-bold text-[11px] text-[#171e19]">99 Envíos</span>
                      </div>
                      <div class="text-base font-extrabold text-[#4d37f6]">$9,800</div>
                      <div class="text-[9px] text-gray-400 mt-0.5">3-5 días hábiles</div>
                    </div>
                  </div>
                  <div class="bg-white rounded-lg p-3 border border-gray-100">
                    <div class="text-[10px] text-gray-400 font-medium mb-3">Tracking · Guía CR-789456</div>
                    <div class="flex items-center">
                      <div class="flex flex-col items-center gap-1">
                        <div class="w-5 h-5 rounded-full bg-[#4d37f6] flex items-center justify-center">
                          <svg class="w-2.5 h-2.5 text-white" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" /></svg>
                        </div>
                        <span class="text-[7px] font-bold text-[#4d37f6]">Recogido</span>
                      </div>
                      <div class="flex-1 h-0.5 bg-[#4d37f6] mx-1"></div>
                      <div class="flex flex-col items-center gap-1">
                        <div class="w-5 h-5 rounded-full bg-[#4d37f6] flex items-center justify-center">
                          <svg class="w-2.5 h-2.5 text-white" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" /></svg>
                        </div>
                        <span class="text-[7px] font-bold text-[#4d37f6]">En tránsito</span>
                      </div>
                      <div class="flex-1 h-0.5 bg-gray-200 mx-1"></div>
                      <div class="flex flex-col items-center gap-1">
                        <div class="w-5 h-5 rounded-full bg-gray-200 border-2 border-gray-300"></div>
                        <span class="text-[7px] font-medium text-gray-400">En destino</span>
                      </div>
                      <div class="flex-1 h-0.5 bg-gray-200 mx-1"></div>
                      <div class="flex flex-col items-center gap-1">
                        <div class="w-5 h-5 rounded-full bg-gray-200 border-2 border-gray-300"></div>
                        <span class="text-[7px] font-medium text-gray-400">Entregado</span>
                      </div>
                    </div>
                  </div>
                </div>
              )}

              <!-- ============ INVOICING MOCKUP ============ -->
              {feature.id === 'facturacion-siigo' && (
                <div class="p-3 bg-[#f8f9fa]">
                  <div class="bg-white rounded-lg border border-gray-100 p-4">
                    <div class="flex justify-between items-start mb-4">
                      <div>
                        <div class="text-[12px] font-extrabold text-[#171e19]">Factura Electrónica</div>
                        <div class="text-[10px] text-gray-400 mt-0.5">FE-2024-0847 · 12 Feb 2024</div>
                      </div>
                      <div class="flex items-center gap-1.5">
                        <span class="bg-emerald-100 text-emerald-700 text-[8px] font-bold px-1.5 py-0.5 rounded">Emitida</span>
                        <span class="bg-[#ede9fe] text-[#4d37f6] text-[8px] font-bold px-1.5 py-0.5 rounded flex items-center gap-0.5">
                          <svg class="w-2 h-2" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" /></svg>
                          DIAN
                        </span>
                      </div>
                    </div>
                    <table class="w-full text-[9px] mb-3">
                      <thead>
                        <tr class="border-b border-gray-100">
                          <th class="text-left py-1.5 text-gray-400 font-medium">Descripción</th>
                          <th class="text-center py-1.5 text-gray-400 font-medium">Cant.</th>
                          <th class="text-right py-1.5 text-gray-400 font-medium">Precio</th>
                          <th class="text-right py-1.5 text-gray-400 font-medium">Total</th>
                        </tr>
                      </thead>
                      <tbody>
                        {[
                          { desc: 'Camiseta Premium', qty: '3', price: '$45,000', total: '$135,000' },
                          { desc: 'Pantalón Cargo', qty: '1', price: '$89,000', total: '$89,000' },
                          { desc: 'Envío Nacional', qty: '1', price: '$12,500', total: '$12,500' },
                        ].map((item) => (
                          <tr class="border-b border-gray-50 last:border-0">
                            <td class="py-1.5 text-[#171e19] font-medium">{item.desc}</td>
                            <td class="py-1.5 text-center text-gray-500">{item.qty}</td>
                            <td class="py-1.5 text-right text-gray-500">{item.price}</td>
                            <td class="py-1.5 text-right text-[#171e19] font-medium">{item.total}</td>
                          </tr>
                        ))}
                      </tbody>
                    </table>
                    <div class="border-t border-gray-200 pt-2 space-y-1">
                      <div class="flex justify-between text-[9px]">
                        <span class="text-gray-400">Subtotal</span>
                        <span class="text-[#171e19] font-medium">$236,500</span>
                      </div>
                      <div class="flex justify-between text-[9px]">
                        <span class="text-gray-400">IVA 19%</span>
                        <span class="text-[#171e19] font-medium">$44,935</span>
                      </div>
                      <div class="flex justify-between text-[11px] font-extrabold border-t border-gray-200 pt-1.5 mt-1">
                        <span class="text-[#171e19]">Total</span>
                        <span class="text-[#4d37f6]">$281,435</span>
                      </div>
                    </div>
                  </div>
                </div>
              )}

              <!-- ============ INVENTORY MOCKUP ============ -->
              {feature.id === 'inventario' && (
                <div class="p-3 bg-[#f8f9fa]">
                  <div class="bg-white rounded-lg border border-gray-100 overflow-hidden">
                    <table class="w-full text-[10px]">
                      <thead>
                        <tr class="border-b border-gray-100 bg-gray-50/80">
                          <th class="text-left py-2 px-3 text-gray-400 font-medium">Producto</th>
                          <th class="text-center py-2 px-3 text-gray-400 font-medium">Principal</th>
                          <th class="text-center py-2 px-3 text-gray-400 font-medium hidden sm:table-cell">Norte</th>
                          <th class="text-center py-2 px-3 text-gray-400 font-medium hidden sm:table-cell">Sur</th>
                          <th class="text-center py-2 px-3 text-gray-400 font-medium">Total</th>
                        </tr>
                      </thead>
                      <tbody>
                        <tr class="border-b border-gray-50">
                          <td class="py-2 px-3 font-medium text-[#171e19]">Camiseta Premium</td>
                          <td class="py-2 px-3 text-center text-gray-500">124</td>
                          <td class="py-2 px-3 text-center text-gray-500 hidden sm:table-cell">86</td>
                          <td class="py-2 px-3 text-center text-gray-500 hidden sm:table-cell">45</td>
                          <td class="py-2 px-3 text-center font-bold text-[#171e19]">255</td>
                        </tr>
                        <tr class="border-b border-gray-50">
                          <td class="py-2 px-3 font-medium text-[#171e19]">Pantalón Cargo</td>
                          <td class="py-2 px-3 text-center text-gray-500">67</td>
                          <td class="py-2 px-3 text-center text-gray-500 hidden sm:table-cell">23</td>
                          <td class="py-2 px-3 text-center text-gray-500 hidden sm:table-cell">41</td>
                          <td class="py-2 px-3 text-center font-bold text-[#171e19]">131</td>
                        </tr>
                        <tr class="border-b border-gray-50">
                          <td class="py-2 px-3 font-medium text-[#171e19]">
                            <span class="flex items-center gap-1 flex-wrap">
                              Hoodie Oversize
                              <span class="bg-red-100 text-red-600 text-[7px] font-bold px-1 py-px rounded shrink-0">Bajo</span>
                            </span>
                          </td>
                          <td class="py-2 px-3 text-center text-red-500 font-bold">3</td>
                          <td class="py-2 px-3 text-center text-red-500 font-bold hidden sm:table-cell">2</td>
                          <td class="py-2 px-3 text-center text-gray-500 hidden sm:table-cell">8</td>
                          <td class="py-2 px-3 text-center font-bold text-red-500">13</td>
                        </tr>
                        <tr>
                          <td class="py-2 px-3 font-medium text-[#171e19]">Gorra Snapback</td>
                          <td class="py-2 px-3 text-center text-gray-500">210</td>
                          <td class="py-2 px-3 text-center text-gray-500 hidden sm:table-cell">98</td>
                          <td class="py-2 px-3 text-center text-gray-500 hidden sm:table-cell">156</td>
                          <td class="py-2 px-3 text-center font-bold text-[#171e19]">464</td>
                        </tr>
                      </tbody>
                    </table>
                  </div>
                  <div class="mt-2 bg-red-50 border border-red-200 rounded-lg px-3 py-2 flex items-center gap-2">
                    <svg class="w-3.5 h-3.5 text-red-500 shrink-0" fill="currentColor" viewBox="0 0 20 20">
                      <path fill-rule="evenodd" d="M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z" clip-rule="evenodd" />
                    </svg>
                    <span class="text-[9px] text-red-600 font-medium">Hoodie Oversize bajo mínimo (10 uds) — Alerta enviada</span>
                  </div>
                </div>
              )}

              <!-- ============ AUTOMATIONS MOCKUP ============ -->
              {feature.id === 'automatizaciones' && (
                <div class="p-4 bg-[#f8f9fa]">
                  <div class="flex items-center justify-between mb-3">
                    <div class="text-[10px] text-gray-400 font-medium">Flujo: Nuevo Pedido Automático</div>
                    <span class="bg-emerald-100 text-emerald-700 text-[8px] font-bold px-1.5 py-0.5 rounded flex items-center gap-1">
                      <span class="w-1 h-1 rounded-full bg-emerald-500"></span>
                      Activo
                    </span>
                  </div>
                  <div class="bg-white rounded-lg border border-gray-100 p-3">
                    <div class="space-y-0">
                      {[
                        { icon: 'cart', label: 'Nuevo Pedido', source: 'Shopify webhook', done: true },
                        { icon: 'card', label: 'Verificar Pago', source: 'Wompi confirmado', done: true },
                        { icon: 'warehouse', label: 'Asignar Bodega', source: 'Regla: cercanía', done: true },
                        { icon: 'truck', label: 'Generar Guía', source: 'Coordinadora', done: false, active: true },
                        { icon: 'invoice', label: 'Facturar', source: 'Siigo automático', done: false },
                        { icon: 'chat', label: 'Notificar Cliente', source: 'WhatsApp plantilla', done: false },
                      ].map((step, idx) => (
                        <div class="flex items-start gap-3">
                          <div class="flex flex-col items-center">
                            <div class={`w-6 h-6 rounded-full flex items-center justify-center shrink-0 ${step.done ? 'bg-[#4d37f6]' : step.active ? 'bg-[#4d37f6]/20 border-2 border-[#4d37f6]' : 'bg-gray-100 border-2 border-gray-200'}`}>
                              {step.done ? (
                                <svg class="w-3 h-3 text-white" fill="currentColor" viewBox="0 0 20 20"><path fill-rule="evenodd" d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z" clip-rule="evenodd" /></svg>
                              ) : step.active ? (
                                <div class="w-2 h-2 rounded-full bg-[#4d37f6] animate-pulse"></div>
                              ) : (
                                <div class="w-1.5 h-1.5 rounded-full bg-gray-300"></div>
                              )}
                            </div>
                            {idx < 5 && (
                              <div class={`w-0.5 h-5 ${step.done ? 'bg-[#4d37f6]' : 'bg-gray-200'}`}></div>
                            )}
                          </div>
                          <div class="pb-3">
                            <div class={`text-[11px] font-bold ${step.done || step.active ? 'text-[#171e19]' : 'text-gray-400'}`}>{step.label}</div>
                            <div class={`text-[9px] ${step.active ? 'text-[#4d37f6] font-medium' : 'text-gray-400'}`}>
                              {step.active ? 'En proceso...' : step.source}
                            </div>
                          </div>
                        </div>
                      ))}
                    </div>
                  </div>
                </div>
              )}
            </div>
          </div>
        ))}
      </div>
    </div>
  </div>
</section>

<script>
  const sections = document.querySelectorAll('[data-feature-section]');
  const navLinks = document.querySelectorAll('[data-feature-nav]');

  const observerOptions = {
    root: null,
    rootMargin: '-30% 0px -60% 0px',
    threshold: 0,
  };

  const observer = new IntersectionObserver((entries) => {
    entries.forEach((entry) => {
      if (entry.isIntersecting) {
        const id = entry.target.id;
        navLinks.forEach((link) => {
          const isActive = link.getAttribute('href') === `#${id}`;
          const dot = link.querySelector('.feature-nav-dot');
          if (isActive) {
            link.classList.remove('text-slate-400');
            link.classList.add('text-[#171e19]', 'font-bold');
            if (dot) {
              dot.classList.remove('bg-slate-300', 'w-1.5', 'h-1.5');
              dot.classList.add('bg-[#4d37f6]', 'w-2', 'h-2');
            }
          } else {
            link.classList.add('text-slate-400');
            link.classList.remove('text-[#171e19]', 'font-bold');
            if (dot) {
              dot.classList.add('bg-slate-300', 'w-1.5', 'h-1.5');
              dot.classList.remove('bg-[#4d37f6]', 'w-2', 'h-2');
            }
          }
        });
      }
    });
  }, observerOptions);

  sections.forEach((section) => observer.observe(section));
</script>
